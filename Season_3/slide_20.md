### ✅ تعریف فیلتر Median

فیلتر Median یکی از روش‌های مقاوم در برابر نویز است که به‌جای گرفتن میانگین از چندین نمونه (مانند ensemble averaging)، **مقدار میانه (median)** را محاسبه می‌کند. این فیلتر به‌ویژه زمانی مؤثر است که برخی از داده‌ها دارای نویز شدید (outlier) باشند.

---

### 📌 مثال عددی از اسلاید ۱۹:

فرض کنید سه سیگنال آغشته به نویز داریم:

```
Noisy signal 1:  -2.15   0.95  -0.25   1.45
Noisy signal 2:  -9.00   0.00   5.00   4.00
Noisy signal 3:  -2.25  -0.45   0.85   1.85
Original:        -2.00   0.00   0.00   2.00
```

### 1️⃣ اعمال فیلتر Median (در هر نقطه‌ی n):

برای مثال در نقطه‌ی `n = 0`:

```
مقدارهای موجود: -2.15, -9.00, -2.25
مرتب‌شده: -9.00, -2.25, -2.15
میانه: -2.25
```

به‌صورت مشابه برای سایر نقاط:

* n = 1: median(0.95, 0.00, -0.45) → **0**
* n = 2: median(-0.25, 5.00, 0.85) → **0.85**
* n = 3: median(1.45, 4.00, 1.85) → **1.85**

پس سیگنال فیلتر شده با median:

```
Median filter:   -2.25   0.00   0.85   1.85
```

---

### 2️⃣ مقایسه با Ensemble Averaging:

**میانگین هر نقطه:**

* n=0: avg(-2.15, -9, -2.25) = **-4.47**
* n=1: avg(0.95, 0.0, -0.45) = **0.17**
* n=2: avg(-0.25, 5, 0.85) = **1.87**
* n=3: avg(1.45, 4, 1.85) = **2.43**

```
Ensemble average: -4.47   0.17   1.87   2.43
```

---

### 📈 مقایسه‌ی کارایی با پارامتر SNR:

در ادامه‌ی اسلاید ۲۰:

| روش                | Energy نویز | SNR (dB) |
| ------------------ | ----------- | -------- |
| Signal 1           | 1.29        | 7.93     |
| Signal 2 (پرنویز)  | 78.00       | -9.89    |
| Signal 3           | 1.01        | 8.99     |
| Ensemble Averaging | 9.81        | 0.88     |
| **Median Filter**  | **0.81**    | **9.95** |

🔍 **نتیجه:** در این مثال، **فیلتر Median بهتر از میانگین‌گیری دسته‌جمعی** عمل کرده است، چون نویز شدید سیگنال دوم روی نتیجه‌ میانگین تأثیر منفی گذاشته است، اما Median تحت تأثیر outlierها قرار نمی‌گیرد.

---

### 🟡 نکته:

اگر تعداد سیگنال‌ها (trials) کم باشد یا برخی سیگنال‌ها نویز زیادی داشته باشند، **فیلتر Median انتخاب بهتری است.** در مقابل، اگر نویز تصادفی و متعادل باشد و تعداد زیادی سیگنال داشته باشیم، **ensemble averaging** می‌تواند خوب عمل کند.
