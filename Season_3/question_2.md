## ✅ **سؤال پیشنهادی طراحی‌شده: ترکیب Moving Average و SNR**

> فرض کنید سیگنال اصلی زیر را داریم که شامل ۶ نمونه است:
>
> ```
> x_original = [2, 4, 6, 8, 6, 4]
> ```
>
> و سیگنال آغشته به نویز (noisy) به صورت زیر داده شده:
>
> ```
> x_noisy = [2.3, 4.5, 5.6, 8.3, 5.5, 3.7]
> ```
>
> **الف)** انرژی سیگنال اصلی و انرژی نویز را حساب کرده و مقدار SNR اولیه را محاسبه کنید.
> **ب)** یک فیلتر Moving Average از مرتبه 3 را روی سیگنال نویزی اعمال کنید.
> **پ)** پس از فیلتر، مجدداً انرژی نویز را محاسبه کرده و **SNR پس از فیلتر** را به‌دست آورید.
> **ت)** آیا فیلتر باعث افزایش SNR شده است؟ چرا؟

---

## ✅ **پاسخ تشریحی (مرحله به مرحله):**

### 🔹 الف) محاسبه انرژی سیگنال و انرژی نویز

#### انرژی سیگنال اصلی:



![Math Formula](<https://latex.codecogs.com/svg.latex?E_%7B%5Ctext%7Bsignal%7D%7D%20%3D%202%5E2%20%2B%204%5E2%20%2B%206%5E2%20%2B%208%5E2%20%2B%206%5E2%20%2B%204%5E2%20%3D%204%20%2B%2016%20%2B%2036%20%2B%2064%20%2B%2036%20%2B%2016%20%3D%20%5Cboxed%7B172%7D>)


#### سیگنال نویز:

```
noise = x_noisy - x_original = [0.3, 0.5, -0.4, 0.3, -0.5, -0.3]
```

#### انرژی نویز:



![Math Formula](<https://latex.codecogs.com/svg.latex?E_%7B%5Ctext%7Bnoise%7D%7D%20%3D%200.3%5E2%20%2B%200.5%5E2%20%2B%200.4%5E2%20%2B%200.3%5E2%20%2B%200.5%5E2%20%2B%200.3%5E2%20%3D%20%0A0.09%20%2B%200.25%20%2B%200.16%20%2B%200.09%20%2B%200.25%20%2B%200.09%20%3D%20%5Cboxed%7B0.93%7D>)


#### محاسبه SNR اولیه:



![Math Formula](<https://latex.codecogs.com/svg.latex?SNR%20%3D%2010%20%5Clog_%7B10%7D%20%5Cleft%28%20%5Cfrac%7B172%7D%7B0.93%7D%20%5Cright%29%20%E2%89%88%2010%20%5Clog_%7B10%7D%28184.9%29%20%E2%89%88%20%5Cboxed%7B22.67%20%5Ctext%7B%20dB%7D%7D>)


---

### 🔹 ب) اعمال فیلتر Moving Average از مرتبه 3:



![Math Formula](<https://latex.codecogs.com/svg.latex?y%5Bn%5D%20%3D%20%5Cfrac%7Bx%5Bn%5D%20%2B%20x%5Bn%2B1%5D%20%2B%20x%5Bn%2B2%5D%7D%7B3%7D>)


بدون zero-padding (می‌گیریم 4 مقدار):

| n | x\[n], x\[n+1], x\[n+2] | y\[n]                  |
| - | ----------------------- | ---------------------- |
| 0 | 2.3, 4.5, 5.6           | (2.3+4.5+5.6)/3 = 4.13 |
| 1 | 4.5, 5.6, 8.3           | 6.13                   |
| 2 | 5.6, 8.3, 5.5           | 6.47                   |
| 3 | 8.3, 5.5, 3.7           | 5.83                   |

→ فیلتر شده:

```
x_filtered = [4.13, 6.13, 6.47, 5.83]
```

مطابقت بدیم با سیگنال اصلی وسطی:

```
x_original_crop = [4, 6, 8, 6]
```

→ نویز جدید:

```
error = [0.13, 0.13, -1.53, -0.17]
E_noise_filtered = 0.017 + 0.017 + 2.34 + 0.028 = \boxed{2.4}
```

---

### 🔹 پ) محاسبه SNR جدید:



![Math Formula](<https://latex.codecogs.com/svg.latex?E_%7B%5Ctext%7Bsignal%20cropped%7D%7D%20%3D%204%5E2%20%2B%206%5E2%20%2B%208%5E2%20%2B%206%5E2%20%3D%2016%20%2B%2036%20%2B%2064%20%2B%2036%20%3D%20%5Cboxed%7B152%7D>)




![Math Formula](<https://latex.codecogs.com/svg.latex?SNR_%7B%5Ctext%7Bfiltered%7D%7D%20%3D%2010%20%5Clog_%7B10%7D%28152%20/%202.4%29%20%E2%89%88%2010%20%5Clog_%7B10%7D%2863.3%29%20%E2%89%88%20%5Cboxed%7B18.0%20%5Ctext%7B%20dB%7D%7D>)


---

### 🔹 ت) نتیجه:

* **SNR اولیه ≈ 22.67 dB**
* **SNR پس از فیلتر ≈ 18.0 dB**
* **کاهش یافته!**

### 🎯 چرا؟

* چون نویز خیلی بزرگ نبود، فیلتر باعث "صاف‌شدن" سیگنال و همچنین **تغییر خود سیگنال اصلی** هم شده.
* در این حالت، فیلتر باعث **تخریب جزئی سیگنال مفید** شده و SNR افت کرده.

