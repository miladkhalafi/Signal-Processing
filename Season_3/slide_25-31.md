## ✅ PCA چیست و چه کاربردی دارد؟

🔹 **هدف اصلی PCA:**
کاهش ابعاد داده یا حذف نویز با استفاده از ترکیب‌های خطی از داده‌ها که بیشترین اطلاعات (واریانس) را نگه می‌دارند.

🔹 در پردازش سیگنال:
با استفاده از PCA می‌تونیم **سیگنال‌های بیولوژیکی چندکاناله یا تکرار شده (مانند EEG یا ECG)** را از نویز جدا کنیم.

---

## 🔢 مثال عددی اصلی (مثال اسلاید 28 تا 31):

فرض می‌کنیم سیگنال ۳ بار ثبت شده (۳ trial)، هرکدام شامل ۴ نمونه است:

```
X = [
  2.9  4.9  5.3  7.3;
  2.9  5.1  5.1  6.9;
  3.1  4.8  5.1  7.0
]
```

هر سطر: یک trial (3×4 ماتریس)

---

## 🟩 مرحله 1: صفر کردن میانگین (اسلاید 25)

### محاسبه میانگین هر ستون:

```
میانگین ستون‌ها:
col1 = (2.9 + 2.9 + 3.1) / 3 = 2.9667
col2 = (4.9 + 5.1 + 4.8) / 3 = 4.9333
col3 = (5.3 + 5.1 + 5.1) / 3 = 5.1667
col4 = (7.3 + 6.9 + 7.0) / 3 = 7.0667
```

### کم کردن میانگین از هر ستون (نتیجه: Xm):

```
Xm =
[
 -0.0667  -0.0333   0.1333   0.2333;
 -0.0667   0.1667  -0.0667  -0.1667;
  0.1333  -0.1333  -0.0667  -0.0667
]
```

---

## 🟩 مرحله 2: محاسبه ماتریس کوواریانس (اسلاید 25)

فرمول:



![Math Formula](<https://latex.codecogs.com/svg.latex?%5Ctext%7BCov%7D%20%3D%20%5Cfrac%7B1%7D%7BN-1%7D%20%5Ccdot%20Xm%20%5Ccdot%20Xm%5ET>)


N = 4 (تعداد نمونه‌ها) → تقسیم بر 3

محاسبه ضرب ماتریسی Xm \* Xmᵀ و تقسیم:

```
A = Xm * Xmᵀ =
[
 0.0733  -0.0400  -0.0333;
 -0.0400  0.0867  -0.0467;
 -0.0333 -0.0467   0.0800
]

Cov = A / 3 =
[
 0.0244 -0.0133 -0.0111;
-0.0133 0.0289 -0.0156;
-0.0111 -0.0156 0.0267
]
```

---

## 🟩 مرحله 3: محاسبه بردارها و مقادیر ویژه (اسلاید 26–27)

ما از تابع خاصی استفاده نمی‌کنیم؛ ولی فرض شده (در اسلاید 28):

### مقادیر ویژه:

```
λ1 = 8.4578
λ2 = 0.0272
λ3 = 0.0017
```

### بردارهای ویژه (ستون‌های ماتریس V):

```
V =
[
  0.7103   0.3335   0.6198;
 -0.1039  -0.8213   0.5610;
 -0.6962   0.4629   0.5487
]
```

---

## 🟩 مرحله 4: مرتب‌سازی براساس مقدار ویژه (اسلاید 29)

ترتیب نزولی براساس λها:

```
اول: λ1 = 8.4578 → v1  
دوم: λ2 = 0.0272 → v2  
سوم: λ3 = 0.0017 → v3
```

→ ماتریس V مرتب شده: Vsort = همان ترتیبی که بالا گفتیم.

---

## 🟩 مرحله 5: محاسبه Z-score (اسلاید 29)



![Math Formula](<https://latex.codecogs.com/svg.latex?Z%20%3D%20V%5E%7BT%7D%20%5Ccdot%20Xm>)


→ خروجی: Z (مقادیر سیگنال‌ها در فضای مؤلفه‌های اصلی)

اسلاید داده:

```
Z =
[
 -3.5843  -0.1776   0.2349   3.5270;
  0.1115  -0.2414   0.0309   0.0991;
 -0.0218  -0.0132   0.0621  -0.0270
]
```

---

## 🟩 مرحله 6: تصمیم‌گیری در مورد تعداد مؤلفه‌ها (اسلاید 30–31)

معمولاً می‌خواهیم مثلاً **۹۹٪ واریانس را نگه داریم**:



![Math Formula](<https://latex.codecogs.com/svg.latex?%5Cfrac%7B%5Clambda_1%7D%7B%5Csum%20%5Clambda_i%7D%20%3D%20%5Cfrac%7B8.4578%7D%7B8.4578%2B0.0272%2B0.0017%7D%20%3D%20%5Cfrac%7B8.4578%7D%7B8.4867%7D%20%E2%89%88%200.9966%20%3D%2099.66%5C%25>)


→ فقط **مؤلفه اول کافیست!**

---

## 🟩 مرحله 7: بازسازی سیگنال بدون نویز (اسلاید 31)



![Math Formula](<https://latex.codecogs.com/svg.latex?X_%7B%5Ctext%7Bnonoise%7D%7D%20%3D%20v_1%20%5Ccdot%20z_1>)


→ فقط مؤلفه اول نگه داشته می‌شود:

```
Xnonoise = V(:,1) * Z(1,:) =
= 0.7103 × [-3.58 ...] + ...
```

مقدار دقیق از اسلاید:

```
Xnonoise =
[
 -2.22  -0.11   0.15   2.19;
 -2.01  -0.10   0.13   1.98;
 -1.97  -0.10   0.13   1.94
]
```

---

## ✅ مزایا و نتیجه PCA:

🔹 فقط با یک مؤلفه اصلی توانستیم سیگنال اصلی را بدون نویز بازسازی کنیم.
🔹 نویز در مؤلفه‌های با مقدار ویژه پایین بوده و حذف شدند.
🔹 واریانس حفظ‌شده = بیش از 99٪

---

## ❓ اگر سؤال طراحی کنیم:

> سیگنال سه‌کاناله شامل ۴ نمونه داریم به صورت:
>
> ```
> X = [3 4 5 6; 2 5 4 7; 4 3 6 5]
> ```
>
> الف) ماتریس بدون میانگین را تشکیل دهید
> ب) ماتریس کوواریانس را حساب کنید
> پ) مؤلفه‌هایی را نگه دارید که بیش از ۹۵٪ واریانس را پوشش می‌دهند
> ت) سیگنال بازسازی‌شده را بنویسید

