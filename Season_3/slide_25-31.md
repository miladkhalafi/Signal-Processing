
## 🔹 اسلاید 25–31: **تحلیل مؤلفه‌های اصلی (PCA)**

### 📌 هدف:

حذف نویز از سیگنال چندکاناله یا چند trial با استفاده از مؤلفه‌هایی که بیشترین انرژی (واریانس) را دارند.

---

### 🔹 مراحل PCA دستی:

فرض کن ماتریس سیگنال‌ شما این است (هر ردیف یک trial):

```
X = [2.9 4.9 5.3 7.3;
     2.9 5.1 5.1 6.9;
     3.1 4.8 5.1 7.0]
```

#### 1️⃣ صفر کردن میانگین (برای هر ستون):

ابتدا میانگین هر ستون را پیدا می‌کنیم:

```
میانگین ستون 1 = (2.9 + 2.9 + 3.1)/3 = 2.9667
میانگین ستون 2 = (4.9 + 5.1 + 4.8)/3 = 4.9333
میانگین ستون 3 = (5.3 + 5.1 + 5.1)/3 = 5.1667
میانگین ستون 4 = (7.3 + 6.9 + 7.0)/3 = 7.0667
```

ماتریس میانگین صفر شده:

```
Xm = X - mean = 
[ -0.0667, -0.0333,  0.1333,  0.2333;
  -0.0667,  0.1667, -0.0667, -0.1667;
   0.1333, -0.1333, -0.0667, -0.0667 ]
```

#### 2️⃣ محاسبه ماتریس کوواریانس:

اگر Xm شکل 3×4 دارد، پس کوواریانس را با:



![Math Formula](<https://latex.codecogs.com/svg.latex?%5Ctext%7BCov%7D%20%3D%20%5Cfrac%7B1%7D%7BN-1%7D%20Xm%20%5Ccdot%20Xm%5ET>)


(در اینجا ![Math](<https://latex.codecogs.com/svg.latex?N%20%3D%204>) پس تقسیم بر 3)

#### 3️⃣ محاسبه مقادیر ویژه و بردارهای ویژه (Eigenvalues و Eigenvectors):

فرض کن ماتریس کوواریانس این مقادیر ویژه را دارد:

```
λ1 = 8.4578
λ2 = 0.0272
λ3 = 0.0017
```

بردارهای ویژه مربوطه:

```
v1 = [...]
v2 = [...]
v3 = [...]
```

#### 4️⃣ مرتب‌سازی:

براساس مقدار ویژه، v1 قوی‌ترین مؤلفه است.

#### 5️⃣ محاسبه Zscore:



![Math Formula](<https://latex.codecogs.com/svg.latex?Z%20%3D%20V%5ET%20%5Ccdot%20Xm>)


فقط مؤلفه اول را نگه می‌داریم چون λ1 تقریباً 99.9٪ انرژی را دارد.

#### 6️⃣ بازسازی سیگنال:



![Math Formula](<https://latex.codecogs.com/svg.latex?X_%7B%5Ctext%7Bno%20noise%7D%7D%20%3D%20v_1%20%5Ccdot%20Z_1>)


#### مزیت:

→ سیگنال بدون نویز بازیابی می‌شود، نویز که انرژی و واریانس کمی دارد، حذف شده.

